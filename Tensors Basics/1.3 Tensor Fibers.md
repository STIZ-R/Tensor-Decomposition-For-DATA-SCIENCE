### 1.3 - Tensor Fibers  

Fibers are the analogs to rows and columns of matrices. Instead of having rows and columns, we talk about fiber. They are always oriented as vector columns.
<br>
For a 3-way tensor $\mathbf{X} \in \mathbb{R}^{m \times n \times p}$, we have:

- **Column fibers** (*mode-1 fibers* of length $m$) are the $np$ fibers of the form
  $\mathbf{x}_{:jk} \in \mathbb{R}^m$.

- **Row fibers** (*mode-2 fibers* of length $n$) are the $mp$ fibers of the form
  $\mathbf{x}_{i:k} \in \mathbb{R}^n$.

- **Tube fibers** (*mode-3 fibers* of length $p$) are the $mn$ fibers of the form
  $\mathbf{x}_{ij:} \in \mathbb{R}^p$.

<br>

> **Definition (Fibers of 3-way Tensor)**  
> Let $\textbf{X}$ be a 3-way tensor of size $m \times n \times p$.
> The **column fibers** are vectors of length $m$ given by $\textbf{X}(:,j,k)$.
> The **row fibers** are vectors of length $n$ given by $\textbf{X}(i,:,k)$.
> The **tube fibers** are vectors of length $p$ given by $\textbf{X}(i,j,:)$.

<br>

We can express more generally the different mode-*k* fibers of a third-order tensor $\textbf{X}$ of size $m \times n \times p$ as:

```math
\begin{aligned}
X(:,j,k) =
\begin{bmatrix}
x_{1jk} \\
x_{2jk} \\
. \\
. \\
. \\
x_{mjk}
\end{bmatrix} \in \mathbb{R}^m, \quad
X(i,:,k) =
\begin{bmatrix}
x_{i1k} \\
x_{i2k} \\
. \\
. \\
. \\
x_{ink}
\end{bmatrix} \in \mathbb{R}^n, \quad 
X(i,j,:) =
\begin{bmatrix}
x_{ij1} \\
x_{ij2} \\
. \\
. \\
. \\
x_{ijp}
\end{bmatrix} \in \mathbb{R}^p, \quad
\end{aligned}

```
<br>

For a *d*-way tensor $\textbf{X}$ of size $n_1 \times n_2 \times \dots \times n_d$, its **mode-*k* fibers** are vectors of length $n_k$$.

<br>

> **Definition (Mode-*k* Fiber)** <br>
> A **mode-*k* fiber** of a tensor is a vector produced by holding all indices but the $k_{th}$ fixed.















## Exercises

<br>

> **Exercise 1.7** <br>
> For a $m \times n \times p$ tensor:  <br>
> a) How many columns fibers are there? <br>
> b) How many row fibers? <br>
> c) How many tube fibers?

### Solutions - Exercise 1.7

**a)** <br>
There are $np$ column fibers.

**b)** <br>
There are $mp$ row fibers.

**c)** <br>
There are $mn$ tube fibers.

<br>
<br>

> **Exercise 1.8** <br>
> For the $3 \times 4 \times 2$ tensor $\textbf{X}$ given below, specify the following fiebrs: <br>
> a) $\textbf{X}(2,:,2)$ <br>
> b) $\textbf{X}(1,4,:)$ <br>
> c) $\textbf{X}(2,3,:)$ <br>
> d) $\textbf{X}(3,:,1)$ <br>
> e) $\textbf{X}(:,2,1)$ <br>

```math
\begin{aligned}
X(:,:,1) =
\begin{bmatrix}
5 & 1 & 5 & 2 \\
7 & 3 & 3 & 8 \\
8 & 9 & 5 & 4
\end{bmatrix}, \quad
X(:,:,2) =
\begin{bmatrix}
5 & 2 & 7 & 1 \\
1 & 9 & 7 & 3 \\
7 & 4 & 8 & 5
\end{bmatrix} \quad
\end{aligned}
```
 ### Solutions - Exercise 1.8

 **a)**
 ```math
\begin{aligned}
X(2,:,2) =
\begin{bmatrix}
1 \\
9 \\
7 \\
3
\end{bmatrix} \quad
\end{aligned}
```

**b)**
```math
\begin{aligned}
X(1,4,:) =
\begin{bmatrix}
2 \\
1
\end{bmatrix} \quad
\end{aligned}
```

**c)**
```math
\begin{aligned}
X(2,3,:) =
\begin{bmatrix}
3 \\
7
\end{bmatrix} \quad
\end{aligned}
```

**d)**
```math
\begin{aligned}
X(3,:,1) =
\begin{bmatrix}
8 \\
9 \\
5 \\
4
\end{bmatrix} \quad
\end{aligned}
```

**e)**
```math
\begin{aligned}
X(:,2,1) =
\begin{bmatrix}
1 \\
3 \\
9
\end{bmatrix} \quad
\end{aligned}
```

<br>
<br>

> **Exercise 1.9** <br>
> Let $\textbf{Y}$ be the 4-way tensor in Figure 3. Specify the following fibers: <br>
> a) $\textbf{Y}(:,1,3,2)$ <br>
> b) $\textbf{Y}(1,:,2,1)$ <br>
> c) $\textbf{Y}(3,3,:,1)$ <br>
> d) $\textbf{Y}(1,2,2,:)$ <br>

> **Figure 3:** Frontal slices of Y

```math
\begin{aligned}
Y(:,:,1,1) =
\begin{bmatrix}
1 & 7 & 5 & 5 \\
8 & 9 & 1 & 7 \\
4 & 5 & 3 & 8
\end{bmatrix}, \quad
Y(:,:,1,2) =
\begin{bmatrix}
7 & 3 & 6 & 7 \\
3 & 5 & 4 & 4 \\
6 & 4 & 5 & 9
\end{bmatrix}, \quad
\\[8pt] 
Y(:,:,2,1) =
\begin{bmatrix}
4 & 9 & 9 & 9 \\
1 & 2 & 1 & 3 \\
3 & 5 & 6 & 5
\end{bmatrix}, \quad
Y(:,:,2,2) =
\begin{bmatrix}
2 & 4 & 4 & 7 \\
7 & 6 & 1 & 5 \\
4 & 5 & 1 & 7
\end{bmatrix}, \quad
\\[8pt] 
Y(:,:,3,1) =
\begin{bmatrix}
9 & 7 & 2 & 5 \\
2 & 7 & 5 & 4 \\
5 & 5 & 4 & 8
\end{bmatrix}, \quad
Y(:,:,3,2) =
\begin{bmatrix}
9 & 3 & 9 & 5 \\
7 & 6 & 9 & 8 \\
1 & 3 & 8 & 2
\end{bmatrix}, \quad
\end{aligned}
```
### Solutions - Exercise 1.9

**a)**
```math
\begin{aligned}
Y(:,1,3,2) =
\begin{bmatrix}
9 \\
7 \\
1
\end{bmatrix} \quad
\end{aligned}
```

**b)**
```math
\begin{aligned}
Y(1,:,2,1) =
\begin{bmatrix}
4 \\
9 \\
9 \\
9
\end{bmatrix} \quad
\end{aligned}
```

**c)**
```math
\begin{aligned}
Y(3,3,:,1) =
\begin{bmatrix}
3 \\
6 \\
4
\end{bmatrix} \quad
\end{aligned}
```

**d)**
```math
\begin{aligned}
Y(1,2,2,:) =
\begin{bmatrix}
9 \\
4
\end{bmatrix} \quad
\end{aligned}
```

<br>
<br>

> **Exercise 1.10 <br>
> For an $m \times n \times p \times q$ tensor: <br>
> a) How many mode-1 fibers are there? <br>
> b) How many mode-2 fibers? <br>
> c) How many mode-3 fibers? <br>
> d) How many mode-4 fibers?

### Solutions - Exercise 1.10

**a)**
There are $npq$ mode-1 fibers.

**b)** 
There are $mpq$ mode-2 fibers.

**c)** 
There are $mnq$ mode-3 fibers.

**d)**
There are $mnp$ mode-4 fibers.




