# 2.3 Unfolding or Matricization of Tensor

A tensor $X$ of size $n_1 \times n_2 \times \dots \times n_d$ is unfolded to a matrix of size $M \times N$, it must be cast that $MN = \prod_{k=1}^dn_k$.

## Unfolding 3-way Tensor

For a 3-way tensor of size $m \times n \times p$, we can unfold it of 3 different ways, $m \times np$, $n \times mp$ or $p \times nm$.
Let take the following example:
```math

A(;,;,1) = \begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}, \qquad A(;,;,2) = \begin{bmatrix} 5 & 6 \\ 7 & 8 \end{bmatrix}

```

And the following unfolding:

```math
\begin{aligned}
X_{(1)} = \begin{bmatrix} 1 & 2 & 5 & 6\\
                          3 & 4 & 7 & 8
                          \end{bmatrix} \\[8pt]
X_{(2)} = \begin{bmatrix} 1 & 3 & 5 & 7\\
                          2 & 4 & 6 & 8
                          \end{bmatrix} \\[8pt]
X_{(3)} = \begin{bmatrix} 1 & 2 & 3 & 4\\
                          5 & 6 & 7 & 8
                          \end{bmatrix}
\end{aligned}
```

> **Definition (Mode-1 Unfolding of a 3-way Tensor)** <br>
> For a tensor $X \in \mathbb{R}^{m \times n \times p}$, the **mode-1 unfolding** is denoted as $X_{(1)}$ and is a matrix of size $m \times np$ such that
```math
\begin{aligned}
X_{(1)} = \begin{bmatrix} x_{111} & x_{121} & \dots & x_{1np} \\
                          x_{211} & x_{221} & \dots & x_{2np} \\
                          \dots     &   \dots   &   \dots &  \dots    \\
                          x_{m11} & x_{m21} & \dots & x_{mnp} \end{bmatrix}  
\\[8pt]
\end{aligned}
X_{(1)}(i,l) = X(i,j,k) \text{ where } l = (k - 1)n+j.

```
<br>

> **Definition (Mode-2 Unfolding of a 3-way Tensor)** <br>
> For a tensor $X \in \mathbb{R}^{m \times n \times p}$, the **mode-2 unfolding** is denoted as $X_{(2)}$ and is a matrix of size $n \times mp$ such that
```math
\begin{aligned}
X_{(2)} = \begin{bmatrix} x_{111} & x_{211} & \dots & x_{m1p} \\
                          x_{121} & x_{221} & \dots & x_{m2p} \\
                          \dots     &   \dots   &   \dots &  \dots    \\
                          x_{1n1} & x_{2n1} & \dots & x_{mnp} \end{bmatrix}  
\\[8pt]
\end{aligned}
X_{(2)}(j,l) = X(i,j,k) \text{ where } l = (k - 1)m+i = \mathbb{L}(j,k).

```

> **Definition (Mode-3 Unfolding of a 3-way Tensor)** <br>
> For a tensor $X \in \mathbb{R}^{m \times n \times p}$, the **mode-2 unfolding** is denoted as $X_{(3)}$ and is a matrix of size $p \times mn$ such that
```math
\begin{aligned}
X_{(3)} = \begin{bmatrix} x_{111} & x_{211} & \dots & x_{mn1} \\
                          x_{112} & x_{212} & \dots & x_{mn2} \\
                          \dots     &   \dots   &   \dots &  \dots    \\
                          x_{11p} & x_{21p} & \dots & x_{mnp} \end{bmatrix}  
\\[8pt]
\end{aligned}
X_{(3)}(k,l) = X(i,j,k) \text{ where } l = (j - 1)m+i = \mathbb{L}(i,j).

```




<br>
<br>

## Exercises

> **Exercise 2.23** <br>
> Prove $X_{(1)} = reshape(X, m \times np)$.

### Solution - Exercise 2.23

<br> <br>

> **Exercise 2.24** <br>
> Let the $2 \times 2 \times 2$ tensor $X$ be given by figure 1. <br>
> What are $X_{(1)}$, $X_{(2)}$ and $X_{(3)}$?

> Figure 1
 ```math
X(;,;,1) = \begin{bmatrix} 8 & 7 \\ -3 & 9 \end{bmatrix}, \qquad X(;,;,2) = \begin{bmatrix} -1 & 4 \\ 0 & 5 \end{bmatrix} 
```

### Solution - Exercise 2.24


```math
X_{(1)} = \begin{bmatrix} 8 & 7 & -1 & 4\\
                          -3 & 9 & 0 & 5
                            \end{bmatrix}
```
```math
X_{(2)} = \begin{bmatrix} 8 & -3 & -1 & 0\\
                          7 & 9 & 4 & 5
                            \end{bmatrix}
```
```math
X_{(3)} = \begin{bmatrix} 8 & 7 & -3 & 9\\
                          -1 & 4 & 0 & 5
                            \end{bmatrix}
```

<br> <br> 

> **Exercise 2.25 (Alternate Column Order in Unfolding)** <br>
> The natural ordering preserves the frontal slices and is generally the default. However, we could certainly change the ordering from the column indicies. Consider: <br>
> $\hat{\mathbf{X}}(i,l) = \mathbf{x}(i,j,k),$ where $l = \mathbb{L}^*(j,k)$ and $(j,k) = \mathbb{T}^*(l)$ <br>
> What is $\hat{\mathbb{X}}_{(1)}$ for the tensor $\mathbf{x}$ from the figure 2?

