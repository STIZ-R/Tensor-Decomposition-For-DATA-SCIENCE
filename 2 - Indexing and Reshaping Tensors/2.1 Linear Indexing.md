## 2.1 Linear Indexing  

For a 3-way tensor $\textbf{X} \in \mathbb{R}^{m \times n \times p}$ , every entry is identified by a 3-tuple of the form $(i,j,k) \in [m] \otimes [n] \otimes [p]$. Another common convention is **linear indexing**, where each entry is mapped to a single index $l \in [mnp]$.

<br>

For a tensor of size $2 \times 2 \times 2$, there are $8!$ possible bijections between tensor entries and linear positions, but most of these mappings are not practically useful. Instead, we restrict attention to mappings that keep fibers and slices contiguous in memory. For such contiguous storage orders, the linearization is defined *via* mode strides, so that the mapping from $(i,j,k)$ to a linear index $l$ has the form
```math
l = 1 + s_1(i-1) + s_2(j-1) + s_3(k-1)
```
So for the previous tensor, we reduce the number of possibilities to only $3!$ since we can permute $(i,j,k)$ in 6 different ways.
<br>
On those 6 differents ways, we have 3 distinct ordering: <br>
- **Natural Ordering**: Having the shortest stride in mode 1, the next shortest in mode 2, *etc* (*)
- **Reverse Ordering**: Having the longest stride in mode 1, the next longest in mode 2, and so on.
- **General Orderings**: Other ordering that keeps different fibers and slices in order.
<br>
In other words, we simply increment \(i\) before \(j\) and before \(k\).  
\((1,1,1), (2,1,1), (1,2,1), (2,2,1), (1,1,2), (2,1,2), (1,2,2), (2,2,2)\)















## Exercies

> **Exercise 2.1** <br>
> List the strides $s_1, s_2 and s_3$ for each of the 6 orderings in Figure 1.

> **Figure 1**

```math
      \begin{aligned}
      a(:,:,1) = \begin{bmatrix} 1 & 3 \\ 2 & 4\end{bmatrix}, \quad a(:,:,2) = \begin{bmatrix} 5 & 7 \\ 6 & 8\end{bmatrix}  
      \\[8pt]
      a) Natural Ordering
\\[16pt]
\\[16pt]
      b(:,:,1) = \begin{bmatrix} 1 & 5 \\ 2 & 6\end{bmatrix}, \quad b(:,:,2) = \begin{bmatrix} 3 & 7 \\ 4 & 8\end{bmatrix}  
      \\[8pt]
      b) General Ordering
      \\[16pt]
\\[16pt]
      c(:,:,1) = \begin{bmatrix} 1 & 2 \\ 3 & 4\end{bmatrix}, \quad c(:,:,2) = \begin{bmatrix} 5 & 6 \\ 7 & 8\end{bmatrix}  
      \\[8pt]
      c) General Ordering
\\[16pt]
\\[16pt]
      d(:,:,1) = \begin{bmatrix} 1 & 5 \\ 3 & 7\end{bmatrix}, \quad d(:,:,2) = \begin{bmatrix} 2 & 6 \\ 4 & 8\end{bmatrix}  
      \\[8pt]
      d) General Ordering
\\[16pt]
\\[16pt]
      e(:,:,1) = \begin{bmatrix} 1 & 2 \\ 5 & 6\end{bmatrix}, \quad e(:,:,2) = \begin{bmatrix} 3 & 4 \\ 7 & 8\end{bmatrix}  
      \\[8pt]
      e) General Ordering
\\[16pt]
\\[16pt]
      f(:,:,1) = \begin{bmatrix} 1 & 3 \\ 5 & 7\end{bmatrix}, \quad f(:,:,2) = \begin{bmatrix} 2 & 4 \\ 6 & 8\end{bmatrix}  
      \\[8pt]
      f) Reverse Ordering
      
      
      \end{aligned}
```

### Solution - Exercise 2.1

**a)**
```math
\begin{aligned}
1 = (1,1,1) , 2 = (2,1,1), 3 = (1,2,1), 4 = (2,2,1), 5 = (1,1,2), 6 = (2,1,2), 7 = (1,2,2), 8 = (2,2,2)       \\[8pt]

(1,1,1) → (2,1,1) : 1 → 2  : s_1 = 2 - 1 = 1        \\[8pt]

(1,1,1) → (1,2,1) : 1 → 3 : s_2 = 3 - 1 = 2       \\[8pt]

(1,1,1) → (1,1,2) : 1 → 5 : s_3 = 5 - 1 = 4
\end{aligned}
```

**b)**
```math
\begin{aligned}

1 = (1,1,1) , 2 = (2,1,1), 5 = (1,2,1), 7 = (2,2,1), 3 = (1,1,2), 7 = (2,1,2), 4 = (1,2,2), 8 = (2,2,2)       \\[8pt]

(1,1,1) → (2,1,1) : 1 → 2  : s_1 = 2 - 1 = 1        \\[8pt]

(1,1,1) → (1,2,1) : 1 → 5 : s_2 = 5 - 1 = 4       \\[8pt]

(1,1,1) → (1,1,2) : 1 → 3 : s_3 = 3 - 1 = 2
\end{aligned}

```

**c)**
```math
\begin{aligned}

1 = (1,1,1) , 3 = (2,1,1), 2 = (1,2,1), 4 = (2,2,1), 5 = (1,1,2), 7 = (2,1,2), 6 = (1,2,2), 8 = (2,2,2)       \\[8pt]

(1,1,1) → (2,1,1) : 1 → 3  : s_1 = 3 - 1 = 2        \\[8pt]

(1,1,1) → (1,2,1) : 1 → 2 : s_2 = 2 - 1 = 1       \\[8pt]

(1,1,1) → (1,1,2) : 1 → 5 : s_3 = 5 - 1 = 4
\end{aligned}

```

**d)**
```math
\begin{aligned}

1 = (1,1,1) , 3 = (2,1,1), 5 = (1,2,1), 7 = (2,2,1), 2 = (1,1,2), 4 = (2,1,2), 6 = (1,2,2), 8 = (2,2,2)       \\[8pt]

(1,1,1) → (2,1,1) : 1 → 3  : s_1 = 3 - 1 = 2       \\[8pt]

(1,1,1) → (1,2,1) : 1 → 5 : s_2 = 5 - 1 = 4       \\[8pt]

(1,1,1) → (1,1,2) : 1 → 2 : s_3 = 2 - 1 = 1
\end{aligned}

```

**e)**
```math
\begin{aligned}

1 = (1,1,1) , 5 = (2,1,1), 2 = (1,2,1), 6 = (2,2,1), 3 = (1,1,2), 7 = (2,1,2), 4 = (1,2,2), 8 = (2,2,2)       \\[8pt]

(1,1,1) → (2,1,1) : 1 → 5  : s_1 = 5 - 1 = 4       \\[8pt]

(1,1,1) → (1,2,1) : 1 → 2 : s_2 = 2 - 1 = 1       \\[8pt]

(1,1,1) → (1,1,2) : 1 → 3 : s_3 = 3 - 1 = 2
\end{aligned}

```

**f)**
```math
\begin{aligned}

1 = (1,1,1) , 5 = (2,1,1), 3 = (1,2,1), 7 = (2,2,1), 2 = (1,1,2), 6 = (2,1,2), 4 = (1,2,2), 8 = (2,2,2)       \\[8pt]

(1,1,1) → (2,1,1) : 1 → 5  : s_1 = 5 - 1 = 4      \\[8pt]

(1,1,1) → (1,2,1) : 1 → 3 : s_2 = 3 - 1 = 2      \\[8pt]

(1,1,1) → (1,1,2) : 1 → 2 : s_3 = 2 - 1 = 1
\end{aligned}

```

